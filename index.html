<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Be My Valentine?</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #ffb6c1, #ffc0cb);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Comic Sans MS', 'Segoe UI', sans-serif;
      overflow: hidden;
      padding: 20px;
    }

    .card {
      background: white;
      padding: 30px 20px;
      border-radius: 20px;
      text-align: center;
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      max-width: 400px;
      width: 100%;
      position: relative;
      z-index: 2;
    }

    #intro, #valentine {
      color: #ff4d6d;
      margin-bottom: 20px;
      font-size: 1.5rem;
      min-height: 1.5em;
      white-space: pre-wrap;
    }

    .cursor {
      display: inline-block;
      width: 2px;
      background-color: #ff4d6d;
      animation: blink 0.7s infinite;
      vertical-align: bottom;
    }

    @keyframes blink {
      0%, 50%, 100% { opacity: 1; }
      25%, 75% { opacity: 0; }
    }

    button {
      padding: 12px 25px;
      font-size: 1rem;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      margin: 10px;
      transition: all 0.2s ease;
    }

    .yes { background-color: #ff4d6d; color: white; }
    .no { background-color: #ccc; color: #333; }

    .message {
      margin-top: 20px;
      font-size: 1.2rem;
      color: #ff4d6d;
      min-height: 30px;
    }

    canvas { position: fixed; top:0; left:0; pointer-events:none; z-index:3; }

    @media (max-width:500px) {
      #intro, #valentine { font-size:1.2rem; }
      button { font-size:0.9rem; padding:10px 20px; }
      .card { padding:25px 15px; }
    }
  </style>
</head>
<body>

<canvas id="fireworks"></canvas>

<div class="card">
  <div id="intro"></div>
  <div id="valentine" style="display:none;"></div>
  <div id="buttons"></div>
  <div class="message" id="message"></div>
</div>

<script>
  // Fireworks setup
  const canvas = document.getElementById("fireworks");
  const ctx = canvas.getContext("2d");
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
  window.addEventListener("resize", () => {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  });

  function startFireworks(callback) {
    const fireworks = [];
    const particles = [];
    let running = true;

    function Firework(x, y) {
      this.x = x;
      this.y = y;
      this.targetY = Math.random() * canvas.height / 2 + 50;
      this.color = `hsl(${Math.random()*360},100%,70%)`;
      this.done = false;
    }

    Firework.prototype.update = function() {
      this.y -= 12;
      if(this.y <= this.targetY && !this.done) {
        this.explode();
        this.done = true;
      }
    }

    Firework.prototype.explode = function() {
      const particleCount = 50 + Math.random()*20;
      for(let i=0;i<particleCount;i++){
        particles.push({
          x:this.x,
          y:this.y,
          vx:Math.cos(Math.random()*2*Math.PI)*(4+Math.random()*2),
          vy:Math.sin(Math.random()*2*Math.PI)*(4+Math.random()*2),
          color:`hsl(${Math.random()*360},100%,${60+Math.random()*20}%)`,
          alpha:1
        });
      }
    }

    function animate(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(let f of fireworks){ f.update(); 
        ctx.beginPath(); ctx.arc(f.x,f.y,3,0,Math.PI*2); ctx.fillStyle=f.color; ctx.fill();
      }
      for(let i=particles.length-1;i>=0;i--){
        const p=particles[i];
        p.x+=p.vx; p.y+=p.vy; p.vy+=0.1; p.alpha-=0.02;
        if(p.alpha<=0) particles.splice(i,1);
        else{ ctx.globalAlpha=p.alpha; ctx.beginPath(); ctx.arc(p.x,p.y,2,0,Math.PI*2); ctx.fillStyle=p.color; ctx.fill(); ctx.globalAlpha=1; }
      }
      if((running || particles.length) && ctx) requestAnimationFrame(animate);
      else if(callback) callback();
    }

    const launchInterval = setInterval(()=>{
      if(running) fireworks.push(new Firework(Math.random()*canvas.width,canvas.height));
    }, 80);

    setTimeout(()=>{ running=false; clearInterval(launchInterval); }, 1000);
    animate();
  }

  // Step logic
  const steps = [
    { text: "Activity? üê∂", yesMessage: "Activity Confirmed! üêæ", noMessage: "Try again! üòÖ" },
    { text: "Dinner? üçΩÔ∏è", yesMessage: "Dinner Confirmed! üçΩÔ∏è", noMessage: "Try again! üòÖ" },
    { text: "Drinks? üçπ", yesMessage: "Drinks Confirmed! üçπ", noMessage: "Try again! üòÖ" },
    { text: "Sussy?", yesOnly:true }
  ];
  let stepIndex = -1;

  function nextStep(answer){
    const messageEl=document.getElementById("message");
    const buttonsDiv=document.getElementById("buttons");
    if(stepIndex===-1){
      messageEl.textContent="Yay! See you on Feb 14th. üíï";
      startFireworks(()=>{ stepIndex++; showStep(); });
      return;
    }
    const currentStep=steps[stepIndex];
    if(!currentStep.yesOnly){
      messageEl.textContent = (answer==="yes") ? currentStep.yesMessage : currentStep.noMessage;
    }
    stepIndex++;
    if(stepIndex < steps.length) setTimeout(showStep,1000);
    else setTimeout(()=>{ messageEl.textContent="‚ù§Ô∏è Can't wait!"; buttonsDiv.innerHTML=""; },1000);
  }

  function showStep(){
    const buttonsDiv=document.getElementById("buttons");
    const currentStep=steps[stepIndex];
    document.getElementById("message").textContent=currentStep.text;

    if(currentStep.yesOnly){
      buttonsDiv.innerHTML=`<button class="yes" onclick="nextStep('yes')">Yes</button>
                            <button class="yes" onclick="nextStep('yes')">üòâ</button>`;
    }else{
      buttonsDiv.innerHTML=`<button class="yes" onclick="nextStep('yes')">Yes</button>
                            <button class="no" onclick="nextStep('no')">No</button>`;
    }
  }

  // Typewriter for intro
  const introEl=document.getElementById("intro");
  const valentineEl=document.getElementById("valentine");
  const buttonsDiv=document.getElementById("buttons");
  const introText="Hey, I need to ask you something...";
  let charIndex=0;

  function typeIntro(){
    if(charIndex<introText.length){
      introEl.textContent+=introText[charIndex];
      charIndex++;
      setTimeout(typeIntro,80);
    }else{
      buttonsDiv.innerHTML=`<button class="yes" onclick="typeValentine()">Yes?!</button>`;
    }
  }

  // Typewriter for Valentine with blinking cursor
  const valentineText="Saniya, will you be my Valentine? üíñ";
  let valCharIndex=0;
  function typeValentine(){
    introEl.style.display="none";
    valentineEl.style.display="inline-block";
    buttonsDiv.innerHTML="";
    const cursor = document.createElement("span");
    cursor.className="cursor";
    valentineEl.appendChild(cursor);

    function type(){
      if(valCharIndex<valentineText.length){
        cursor.insertAdjacentText("beforebegin", valentineText[valCharIndex]);
        valCharIndex++;
        setTimeout(type,80);
      }else{
        cursor.remove();
        buttonsDiv.innerHTML=`<button class="yes" onclick="nextStep('yes')">Yes</button>
                              <button class="no" onclick="nextStep('no')">No</button>`;
      }
    }
    type();
  }

  typeIntro();
</script>
</body>
</html>
